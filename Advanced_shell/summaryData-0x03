#!/bin/bash

# Create CSV header
echo "Name,Height (m),Weight (kg)" > pokemon_report.csv

# Process each JSON file and extract data
for file in pokemon_data/*.json; do
    jq -r '[.name, (.height/10), (.weight/10)] | @csv' "$file" >> pokemon_report.csv
done

# Display the report
echo "CSV Report generated at: pokemon_report.csv"
echo ""
cat pokemon_report.csv
echo ""

# Calculate averages using awk
awk -F',' 'NR>1 { 
    height += $2; 
    weight += $3; 
    count++ 
} 
END { 
    printf "\nAverage Height: %.2f m\n", height/count;
    printf "Average Weight: %.2f kg\n", weight/count;
}' pokemon_report.csv