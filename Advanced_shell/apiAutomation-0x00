#!/bin/bash

# API endpoint for Pikachu
API_URL="https://pokeapi.co/api/v2/pokemon/pikachu"
OUTPUT_FILE="data.json"
ERROR_FILE="errors.txt"

# Function to handle errors
handle_error() {
    local error_msg="$1"
    local timestamp=$(date +"%Y-%m-%d %H:%M:%S")
    echo "[$timestamp] ERROR: $error_msg" >> "$ERROR_FILE"
    echo "Error: $error_msg. Details logged to $ERROR_FILE"
    exit 1
}

# Check if curl is installed
if ! command -v curl &> /dev/null; then
    handle_error "curl command not found. Please install curl to continue."
fi

# Make the API request and save to data.json
echo "Fetching Pikachu data from PokeAPI..."
HTTP_STATUS=$(curl -s -w "%{http_code}" -o "$OUTPUT_FILE" "$API_URL")

# Check HTTP status code
if [ "$HTTP_STATUS" -eq 200 ]; then
    echo "Successfully fetched Pikachu data and saved to $OUTPUT_FILE"
    echo "Use 'jq . < $OUTPUT_FILE | head -n 50' to view the first 50 lines"
else
    handle_error "Failed to fetch Pikachu data (HTTP Status: $HTTP_STATUS)"
fi